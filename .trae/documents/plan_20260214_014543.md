# MBTI人格分析报告实现计划

## 功能概述
在"吾"模块（MirrorProfile）中接入MBTI维度分析，生成包含基础维度分析、认知功能栈分析、人格类型变化追踪、成长建议的综合报告。

## 实现步骤

### 1. 前端 - 类型定义更新
**文件**: `web-ui/src/types.ts`

添加 `MbtiDimension`、`CognitiveFunction`、`ContextMask`、`MbtiAnalysis` 类型到 `MirrorProfile` 接口中。

### 2. 前端 - API 调用更新
**文件**: `web-ui/src/api.ts`

无需修改，保持现有的 `generateMirrorProfile()` 调用即可。

### 3. 后端 - LLM Prompt 修改
**文件**: `nanobot/web/api.py`

修改 `generate_mirror_profile()` 中的 `user_content`：
- 添加 MBTI 分析指令，要求 LLM 输出四维度倾向、置信度、关键证据
- 添加认知功能栈分析（Fi/Ne/Si/Te 等）
- 添加人格类型变化追踪和情境面具
- 添加成长建议

### 4. 前端 - MBTI 报告展示组件
**文件**: `web-ui/src/pages/mirror/WoTab.tsx`

添加 MBTI 报告展示区域：
- 基础维度分析表格（E/I, S/N, T/F, J/P）
- 认知功能栈可视化
- 情境面具分析
- 成长建议

### 5. 前端 - 国际化
**文件**: `web-ui/src/i18n/locales/zh-CN.json` 和 `en.json`

添加 MBTI 相关翻译文本。

## 数据结构

```typescript
interface MbtiDimension {
 倾向: 'E' | 'I' | 'S' | 'N' | 'T' | 'F' | 'J' | 'P'
 得分: string  // 如 "72/28"
 置信度: number  // 0-100
 关键证据: string[]
}

interface CognitiveFunction {
 功能: string  // 如 "内倾情感 (Fi)"
 强度: number  // 0-100
 表现: string
}

interface ContextMask {
 情境: string
 显现类型: string
 面具厚度: number  // 0-100
}

interface MbtiAnalysis {
 当前类型: string  // 如 "INFP"
 历史类型分布: string  // 如 "INFP(65%), INTP(20%)..."
 类型漂移: string
 维度: {
   EI: MbtiDimension
   SN: MbtiDimension
   TF: MbtiDimension
   JP: MbtiDimension
 }
 认知功能栈: {
   主导: CognitiveFunction
   辅助: CognitiveFunction
   第三: CognitiveFunction
   劣势: CognitiveFunction
 }
 情境面具: ContextMask[]
 成长建议: {
     挑战: string
     练习: string
     预期: string
   }[]
}
```

## 输出示例
生成的报告将包含用户提供的完整 MBTI 报告格式，包括表格、进度条、可视化图表等。
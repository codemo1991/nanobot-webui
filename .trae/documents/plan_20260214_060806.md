## 优化实施计划（含 MiniMax 支持）

### 第一优先级：代码精简与可维护性

#### 1. 精简 LiteLLM Provider 模型前缀处理
- **位置**: `nanobot/providers/litellm_provider.py`
- **优化内容**:
  - 提取 `_ensure_model_prefix()` 方法，使用配置映射表
  - 添加 MiniMax 支持（`minimax/` 前缀）
  - 添加零一万物（01ai）支持
- **收益**: 添加新 provider 支持从 10+ 行减少到 1 行配置

#### 2. 优化 Agent Loop 代码结构
- **位置**: `nanobot/agent/loop.py`
- **问题**: `_process_message` 和 `_process_system_message` 有大量重复代码（约 200 行）
- **优化**: 提取公共方法 `_run_agent_loop()`，减少重复
- **收益**: 更易维护，符合 DRY 原则

### 第二优先级：功能增强

#### 3. 添加 MiniMax Provider 支持
- **位置**: `nanobot/providers/litellm_provider.py`
- **配置方式**:
  ```json
  {
    "providers": {
      "minimax": {
        "apiKey": "your-minimax-api-key",
        "apiBase": "https://api.minimax.chat/v1"
      }
    },
    "agents": {
      "defaults": {
        "model": "minimax/MiniMax-Text-01"
      }
    }
  }
  ```
- **需要处理**:
  - `minimax/` 前缀添加
  - `MINIMAX_API_KEY` 环境变量设置
  - API Base URL 识别
- **收益**: 支持 MiniMax 模型

#### 4. 配置加载错误处理优化
- **位置**: `nanobot/config/loader.py`
- **优化**: 添加更友好的错误提示和自动修复建议
- **收益**: 改善首次使用体验

### 第三优先级：架构优化（可选）

#### 5. 工具注册表优化
- **位置**: `nanobot/agent/tools/registry.py`
- **优化**: 添加按需加载机制（类似 OpenClaw Skills）
- **收益**: 减少冷启动时间

### 预期效果
- 添加新 provider 时间从 10 分钟减少到 1 分钟
- MiniMax 支持即插即用
- 保持架构稳定，不破坏现有功能
- 与上游 "Less code, more reliable" 理念保持一致